!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).webvm=e()}}(function(){var e,t,n=(e=function(e,t){(function(e,n){var r=z.nextTick,i=(Function.prototype.apply,Array.prototype.slice),o={},s=0;function a(e,t){this._id=e,this._clearFn=t}a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},t.setImmediate="function"==typeof e?e:function(e){var n=s++,a=!(arguments.length<2)&&i.call(arguments,1);return o[n]=!0,r(function(){o[n]&&(a?e.apply(null,a):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof n?n:function(e){delete o[e]}}).call(this,n({}).setImmediate,n({}).clearImmediate)},function(n){return t||e(t={exports:{},parent:n},t.exports),t.exports}),r={};Object.defineProperty(r,"__esModule",{value:!0});const i=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||Date.now,o=["ms","moz","webkit","o"];r.GetRAF=function(){let e=0;const n={};for(var r=0;r<o.length&&!window.requestAnimationFrame;++r)n.requestAnimationFrame=window[o[r]+"RequestAnimationFrame"],n.cancelAnimationFrame=window[o[r]+"CancelAnimationFrame"]||window[o[r]+"RequestCancelAnimationFrame"];return n.requestAnimationFrame&&n.cancelAnimationFrame||(n.requestAnimationFrame=function(n,r){const o=i(),s=Math.max(0,1e3/60-(o-e)),a=window.setTimeout(function(){try{n(o+s)}catch(t){console.log("Error: ",t),setTimeout(function(){throw t},0)}},s);return e=o+s,a}),n.cancelAnimationFrame||(n.cancelAnimationFrame=function(e){clearTimeout(e)}),n};var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.AnimationQueue=class{constructor(){this.skip=!1,this.binded=!1,this.requestAnimationID=-1,this.frames=new Array,this.bindCycle=this.cycle.bind(this),this.rafProvider=r.GetRAF()}new(){const e=new a(this.frames.length,this);return this.frames.push(e),e}add(e){e.queueIndex=this.frames.length,e.queue=this,this.frames.push(e)}resume(){this.skip=!1}pause(){this.skip=!0}unbind(){if(!this.binded)return null;this.rafProvider.cancelAnimationFrame(this.requestAnimationID)}bind(){if(this.binded)return null;this.requestAnimationID=this.rafProvider.requestAnimationFrame(this.bindCycle,null),this.binded=!0}cycle(e){0!==this.frames.length?(this.frames.forEach(function(t){t.paused()||t.animate(e)}),this.bind()):this.binded=!1}};class a{constructor(e,t){this.skip=!1,this.queue=t,this.queueIndex=e,this.callbacks=new Array}add(e){this.callbacks.push(e)}clear(){this.callbacks.length=0}paused(){return this.skip}pause(){this.skip=!0}stop(){if(this.pause(),-1===this.queueIndex)return null;if(0==this.queue.frames.length)return this.queue=void 0,this.queueIndex=-1,null;const e=this.queue.frames.length;if(1==e)return this.queue.frames.pop(),this.queue=void 0,this.queueIndex=-1,null;this.queue.frames[this.queueIndex]=this.queue.frames[e-1],this.queue.frames.length=e-1,this.queue=void 0,this.queueIndex=-1}animate(e){for(let t in this.callbacks)(0,this.callbacks[t])(e)}}s.AFrame=a;var u,c={};Object.defineProperty(c,"__esModule",{value:!0}),(u=c.Objects||(c.Objects={})).PatchWith=function(e,t,n){e[t]=n},u.GetAttrWith=function(e,t){return e[t]},u.isNullOrUndefined=function(e){return null==e},u.isAny=function(e,...t){for(let n of t)if(e===n)return!0;return!1};var l={};Object.defineProperty(l,"__esModule",{value:!0});const f=Object.prototype.hasOwnProperty;function d(){}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}l.Blank=d,d.prototype=Object.create(null),l.has=function(e,t){return f.call(e,t)},l.createMap=function(){return new d},l.truncateArray=function(e,t){for(;e.length>t;)e.pop()},l.decodeFormBody=function(e){let t=new FormData;return e.trim().split("&").forEach(function(e){if(e){let n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t},l.parseHTTPHeaders=function(e){let t=new Headers;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){let n=e.split(":"),r=n.shift().trim();if(r){let e=n.join(":").trim();t.append(r,e)}}),t},l.fileReaderReady=h,l.readBlobAsArrayBuffer=function(e){let t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n},l.readBlobAsText=function(e){let t=new FileReader,n=h(t);return t.readAsText(e),n},l.readArrayBufferAsText=function(e){let t=new Uint8Array(e),n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")},l.bufferClone=function(e){if(e.slice)return e.slice(0);{let t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}};var p={};function m(e){return 11===e.nodeType||9===e.nodeType}function y(e,t){const n=[];let r=e;for(;r!==t;){const e=r;n.push(e),r=e.parentNode}return n}Object.defineProperty(p,"__esModule",{value:!0}),p.ELEMENT_NODE=1,p.DOCUMENT_FRAGMENT_NODE=11,p.DOCUMENT_NODE=9,p.TEXT_NODE=3,p.COMMENT_NODE=8,l.createMap().style=P,p.isDocumentRoot=m,p.isElement=function(e){return 1===e.nodeType},p.isText=function(e){return 3===e.nodeType},p.getAncestry=y;const b=Node.prototype.getRootNode||function(){let e=this,t=e;for(;e;)t=e,e=e.parentNode;return t};function v(e,t,n){let r=e.firstChild;for(t(r)&&n.push(r);r;)t(r.nextSibling)&&n.push(r),r=r.nextSibling}function w(e,t,n){let r=e.firstChild;for(;r;)t(r)&&n.push(r),r=r.firstChild}function g(e,t){let n=e.firstChild;for(;n;){if(t(n))return n;n=n.nextSibling}return null}function _(e,t){let n=e.firstChild;for(;n;){if(t(n))return n;n=n.firstChild}return null}function E(e){const t=b.call(e);return m(t)?t.activeElement:null}function O(e){return 0===e.lastIndexOf("xml:",0)?"http://www.w3.org/XML/1998/namespace":0===e.lastIndexOf("xlink:",0)?"http://www.w3.org/1999/xlink":void 0}function N(e,t,n){if(null==n)e.removeAttribute(t);else{const r=O(t);r?e.setAttributeNS(r,t,String(n)):e.setAttribute(t,String(n))}}function A(e,t){for(let n in t)null!=t[n]?e.setAttribute(n,t[n]):e.removeAttribute(n)}function T(e,t,n){e[t]=n}function x(e,t,n){t.indexOf("-")>=0?e.setProperty(t,n):e[t]=n}function P(e,t,n){if("string"==typeof n)e.style.cssText=n;else{e.style.cssText="";const t=e.style;for(const e in n)l.has(n,e)&&x(t,e,n[e])}}p.reverseCollectNodeWithBreadth=function(e,t,n){let r=e.lastChild;for(;r;)t(r)&&n.push(r),r=r.previousSibling},p.reverseFindNodeWithBreadth=function(e,t){let n=e.lastChild;for(;n;){if(t(n))return n;n=n.previousSibling}return null},p.collectNodeWithBreadth=v,p.collectNodeWithDepth=w,p.findNodeWithBreadth=g,p.findNodeWithDepth=_,p.findDepthFirst=function(e,t){let n=e.firstChild;for(;n;){const e=_(n,t);if(e)return e;n=n.nextSibling}return null},p.collectDepthFirst=function(e,t,n){let r=e.firstChild;for(;r;)w(r,t,n),r=r.nextSibling},p.findBreadthFirst=function(e,t){let n=e.firstChild;for(;n;){const e=g(n,t);if(e)return e;n=n.firstChild}return null},p.applyEachNode=function e(t,n){n(t);let r=t.firstChild;for(;r;)e(r.nextSibling,n),r=r.nextSibling},p.reverseApplyEachNode=function e(t,n){let r=t.lastChild;for(;r;)e(r,n),r=r.previousSibling;n(t)},p.collectBreadthFirst=function(e,t,n){let r=e.firstChild;for(;r;)v(r,t,n),r=r.firstChild},p.getActiveElement=E,p.getFocusedPath=function(e,t){const n=E(e);return n&&e.contains(n)?y(n,t):[]},p.moveBefore=function(e,t,n){const r=t.nextSibling;let i=n;for(;null!==i&&i!==t;){const t=i.nextSibling;e.insertBefore(i,r),i=t}},p.insertBefore=function(e,t,n){return null===n?(e.appendChild(t),null):(e.insertBefore(t,n),null)},p.replaceNode=function(e,t,n){return null===n?null:(e.replaceChild(n,t),null)},p.replaceNodeIf=function(e,t){if(null===t)return!1;const n=e.parentNode;return!!n&&(n.replaceChild(t,e),!0)},p.getNamespace=O,p.applyAttr=N,p.applyAttrs=A,p.applyProp=T,p.setStyleValue=x,p.applySVGStyle=function(e,t,n){if("string"==typeof n)e.style.cssText=n;else{e.style.cssText="";const t=e.style;for(const e in n)l.has(n,e)&&x(t,e,n[e])}},p.applyStyle=P,p.applyStyles=function(e,t){if("string"==typeof t)e.style.cssText=t;else{e.style.cssText="";const n=e.style;for(const e in t)l.has(t,e)&&x(n,e,t[e])}},p.applySVGStyles=function(e,t){if("string"==typeof t)e.style.cssText=t;else{e.style.cssText="";const n=e.style;for(const e in t)l.has(t,e)&&x(n,e,t[e])}},p.applyAttributeTyped=function(e,t,n){const r=typeof n;"object"===r||"function"===r?T(e,t,n):N(e,t,n)},p.getNamespaceForTag=function(e,t){return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/Math/MathML":null==t?null:t.namespaceURI},p.recordAttributes=function(e){const t={},n=e.attributes,r=n.length;if(!r)return t;for(let i=0,o=0;i<r;i+=1,o+=2){const e=n[i];t[e.name]=e.value}return t},p.createElement=function(e,t,n,r,i,o){let s;if("function"==typeof t)return new t;if((o=o.trim()).length>0)switch(t){case"svg":s=e.createElementNS("http://www.w3.org/2000/svg",t);break;case"math":s=e.createElementNS("http://www.w3.org/1998/Math/MathML",t);break;default:s=e.createElementNS(o,t)}else s=e.createElement(t);return s.setAttribute("_key",n),i&&A(s,i),r.length>0&&(s.innerHTML=r),s},p.createText=function(e,t,n){const r=e.createTextNode(t);return c.Objects.PatchWith(r,"key",n),r},p.removeFromNode=function(e,t){const n=e.parentNode;let r=e;for(;r!==t;){const e=r.nextSibling;n.removeChild(r),r=e}};var S,M={exports:{}};S=function(e){"use strict";var n={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(n.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};function o(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function a(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n.iterable&&(t[Symbol.iterator]=function(){return t}),t}function u(e){this.map={},e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function l(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=l(t);return t.readAsArrayBuffer(e),n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:n.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:n.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():n.arrayBuffer&&n.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||i(e))?this._bodyArrayBuffer=d(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,r=c(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=l(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(e,t){e=o(e),t=s(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},u.prototype.delete=function(e){delete this.map[o(e)]},u.prototype.get=function(e){return e=o(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(o(e))},u.prototype.set=function(e,t){this.map[o(e)]=s(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),a(e)},u.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),a(e)},u.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),a(e)},n.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(e,t){var n,r,i=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new u(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),p.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function y(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function b(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},h.call(m.prototype),h.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:0,statusText:""});return e.type="error",e};var v=[301,302,303,307,308];b.redirect=function(e,t){if(-1===v.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})},e.DOMException=self.DOMException;try{new e.DOMException}catch(g){e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function w(t,r){return new Promise(function(i,o){var s=new m(t,r);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new u,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;i(new b(r,n))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&n.blob&&(a.responseType="blob"),s.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)})}w.polyfill=!0,self.fetch||(self.fetch=w,self.Headers=u,self.Request=m,self.Response=b),e.Headers=u,e.Request=m,e.Response=b,e.fetch=w,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof M.exports?S(M.exports):S(this.WHATWGFetch={}),M=M.exports;var C={};Object.defineProperty(C,"__esModule",{value:!0}),C.fetchAPI={fetch:self.fetch,Headers:self.Headers,Request:self.Request,Response:self.Response,DOMException:self.DOMException},self.fetch||(C.fetchAPI.fetch=M.fetch,C.fetchAPI.Headers=M.Headers,C.fetchAPI.Request=M.Request,C.fetchAPI.Response=M.Response,C.fetchAPI.DOMException=M.DOMException,self.fetch=M.fetch,self.Headers=M.Headers,self.Request=M.Request,self.Response=M.Response,self.DOMException=M.DOMException);var D={};Object.defineProperty(D,"__esModule",{value:!0}),D.default={};var j={};function F(e,t,n){return(t-e)*n+e}function B(e,t){const n=R();return n(e)/n(t)/n(e-t)}function R(){const e=[1];return function(t){let n=1;if(e[t])return e[t];for(let e=t;e>1;e--)n*=e;return e[t]=n,n}}function I(e,t,n,r,i){var o=.5*(n-e),s=.5*(r-t),a=i*i;return(2*t-2*n+o+s)*(i*a)+(-3*t+3*n-2*o-s)*a+o*i+t}Object.defineProperty(j,"__esModule",{value:!0}),j.LinearSum=F,j.BernsteinDivision=B,j.FactorialGenerator=R,j.CatmullRomSum=I,j.Linear=function(e,t){const n=e.length-1,r=n*t,i=Math.floor(r);return t<0?F(e[0],e[1],r):t>1?F(e[n],e[n-1],n-r):F(e[i],e[i+1>n?n:i+1],r-i)},j.Bezier=function(e,t){const n=e.length-1,r=Math.pow;let i=0;for(let o=0;o<=n;o++)i+=r(1-t,n-o)*r(t,o)*e[o]*B(n,o);return i},j.CatmullRom=function(e,t){const n=e.length-1;let r=n*t,i=Math.floor(r);return e[0]===e[n]?(t<0&&(r=n*(1+t),i=Math.floor(r)),I(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(I(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(I(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):I(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)};var k={};function q(e,t){t(e),e.children.forEach(function(e){q(e,t)})}function W(e,t){const n=e.name+"#"+e.id,r=t.querySelectorAll(n);if(0===r.length){let n=e.name+`[_tid='${e.tid}']`,r=t.querySelector(n);return r||(n=e.name+`[_atid='${e.atid}']`,(r=t.querySelector(n))?r:(n=e.name+`[_ref='${e.ref}']`,t.querySelector(n)))}if(1===r.length)return r[0];const i=r.length;for(let o=0;o<i;o++){const t=r.item(o);if(t.getAttribute("_tid")===e.tid)return t;if(t.getAttribute("_atid")===e.atid)return t;if(t.getAttribute("_ref")===e.ref)return t}return null}function U(e,t){const n=e.split("/").map(function(e){return""===e.trim()?"":"#"+e});if(0===n.length)return null;""!==n[0]&&""!==n[0].trim()||n.shift(),n.pop();const r=n[0];t.id==r.substr(1)&&n.shift();let i=t.querySelector(n.shift());for(;i;){if(0===n.length)return i;i=i.querySelector(n.shift())}return i}function L(e,t,n,r){if(t.type===p.COMMENT_NODE){const n=e.createComment(t.content);return c.Objects.PatchWith(n,"_id",t.id),c.Objects.PatchWith(n,"_ref",t.ref),c.Objects.PatchWith(n,"_tid",t.tid),c.Objects.PatchWith(n,"_atid",t.atid),n}if(t.type===p.TEXT_NODE){const n=e.createTextNode(t.content);return c.Objects.PatchWith(n,"_id",t.id),c.Objects.PatchWith(n,"_ref",t.ref),c.Objects.PatchWith(n,"_tid",t.tid),c.Objects.PatchWith(n,"_atid",t.atid),n}let i;return i=0!==t.namespace.length?e.createElement(t.name):e.createElementNS(t.namespace,t.name),c.Objects.PatchWith(i,"_id",t.id),c.Objects.PatchWith(i,"_ref",t.ref),c.Objects.PatchWith(i,"_tid",t.tid),c.Objects.PatchWith(i,"_atid",t.atid),i.setAttribute("id",t.id),i.setAttribute("_tid",t.tid),i.setAttribute("_ref",t.ref),i.setAttribute("_atid",t.atid),i.setAttribute("events",J(t.events)),t.attrs.forEach(function(e){i.setAttribute(e.Key,e.Value)}),t.removed?(i.setAttribute("_removed","true"),i):(n||t.children.forEach(function(t){r&&t.removed||i.appendChild(L(e,t,n,r))}),i)}function J(e){const t=new Array;return e.forEach(function(e){const n=e.Name+"-"+(e.PreventDefault?"1":"0")+(e.StopPropagation?"1":"0");t.push(n)}),t.join(" ")}function H(e,t,n,r){if(!n.Same(t,e)){const n=r.Make(document,e,!1,!0);return void p.replaceNode(t.parentNode,t,n)}if(!n.Changed(t,e))return;V(e,t);const i=t.childNodes.length,o=e.children.length;let s=0;for(;s<i;s++){const i=t.childNodes[s];s>=o?i.remove():H(e.children[s],i,n,r)}for(;s<o;s++){const n=r.Make(document,e,!1,!0);t.appendChild(n)}}function G(e,t,n,r){if(!n.Same(t,e)){const n=r.Make(document,e,!1,!0);return void p.replaceNode(t.parentNode,t,n)}n.Changed(t,e)&&V(e,t);const i=t.childNodes.length,o=e.children.length;let s=0;for(;s<i;s++){const i=t.childNodes[s];if(s>=o)return;H(e.children[s],i,n,r)}for(;s<o;s++){const n=r.Make(document,e,!1,!0);t.appendChild(n)}}function V(e,t){const n=p.recordAttributes(t);e.attrs.forEach(function(e){const r=n[e.Key];if(delete n[e.Key],e.Value===r)return null;t.setAttribute(e.Key,e.Value)});for(let r in n)t.removeAttribute(r);t.setAttribute("_tid",e.tid),t.setAttribute("_ref",e.ref),t.setAttribute("_atid",e.atid),t.setAttribute("events",J(e.events)),c.Objects.PatchWith(t,"_id",e.id),c.Objects.PatchWith(t,"_ref",e.ref),c.Objects.PatchWith(t,"_tid",e.tid),c.Objects.PatchWith(t,"_atid",e.atid)}function Q(e,t){const n=p.recordAttributes(t);for(let r in e.attributes){const i=e.attributes[r],o=n[i.name];delete n[i.name],i.value!==o&&t.setAttribute(i.name,i.value)}for(let r in n)t.removeAttribute(r)}Object.defineProperty(k,"__esModule",{value:!0}),k.DefaultNodeDictator={Same:(e,t)=>e.nodeType==t.nodeType&&e.nodeName==t.nodeName,Changed:(e,t)=>!1},k.applyJSONNodeFunction=q,k.applyJSONNodeKidsFunction=function(e,t){e.children.forEach(function(e){q(e,t)}),t(e)},k.isJSONNode=function(e){const t=void 0!==e.id,n=void 0!==e.ref,r=void 0!==e.tid,i=void 0!==e.typeName;return t&&n&&i&&r},k.findElement=W,k.findElementbyRef=function(e,t){const n=e.split("/").map(function(e){return""===e.trim()?"":"#"+e});if(0===n.length)return null;""!==n[0]&&""!==n[0].trim()||n.shift();const r=n[0];t.id==r.substr(1)&&n.shift();let i=t.querySelector(n.shift());for(;i;){if(0===n.length)return i;i=i.querySelector(n.shift())}return i},k.findElementParentbyRef=U,k.DefaultJSONDictator={Same:(e,t)=>!1,Changed:(e,t)=>!1},k.DefaultJSONMaker={Make:L},k.jsonMaker=L,k.BuildEvent=J,k.PatchJSONNodeTree=function(e,t,n,r){let i=W(e,t);c.Objects.isNullOrUndefined(i)?(r.Make(document,e,!1,!0),t.appendChild(i)):H(e,i,n,r)},k.PatchJSONNode=H,k.StreamJSONNodes=function(e,t,n,r){const i=e.filter(function(e){return!e.removed});e.filter(function(e){if(!e.removed)return!1;let t=!0;return i.forEach(function(n){e.tid!==n.tid&&e.tid!=n.atid&&e.ref!==n.ref||(t=!1)}),t}).forEach(function(e){const n=W(e,t);n&&n.remove()}),i.forEach(function(e){const i=W(e,t);if(c.Objects.isNullOrUndefined(i)){const n=U(e.ref,t);if(c.Objects.isNullOrUndefined(n))return void console.log("Unable to apply new change stream: ",e);const i=r.Make(document,e,!1,!0);n.appendChild(i)}else G(e,i,n,r)})},k.ApplyStreamNode=G,k.PatchTextCommentWithJSON=function(e,t){e.type!==p.COMMENT_NODE&&e.type!==p.TEXT_NODE||e.type!==p.COMMENT_NODE&&e.type!==p.TEXT_NODE||t.textContent!==e.content&&(t.textContent=e.content,c.Objects.PatchWith(t,"_ref",e.ref),c.Objects.PatchWith(t,"_tid",e.tid),c.Objects.PatchWith(t,"_atid",e.atid))},k.PatchJSONAttributes=V,k.PatchDOMTree=function e(t,n,r,i){if(i){const e=n.parentNode;if(!r.Same(n,t))return p.replaceNode(e,n,t),null;if(!n.hasChildNodes())return p.replaceNode(e,n,t),null}const o=n.childNodes,s=o.length,a=t.childNodes,u=a.length,c=u<s;let l,f,d,h=0;for(;h<s&&!(h>=u);h++){if(l=o[h],d=a[h],f=l.nextSibling,!r.Same(l,d)){p.replaceNode(n,l,d);continue}if(!r.Changed(l,d))continue;if(l.nodeType===p.TEXT_NODE||l.nodeType===p.COMMENT_NODE){l.textContent!==d.textContent&&(l.textContent=d.textContent);continue}if(!l.hasChildNodes()&&d.hasChildNodes()){p.replaceNode(n,l,d);continue}if(l.hasChildNodes()&&!d.hasChildNodes()){p.replaceNode(n,l,d);continue}const t=l,i=d;Q(i,t),t.setAttribute("_patched","true"),e(i,t,r,!0),t.removeAttribute("_patched")}if(c&&null!==f)return p.removeFromNode(f,null),null;for(;h<u;h++){const e=a[h];n.appendChild(e)}},k.PatchDOMAttributes=Q;var X={};Object.defineProperty(X,"__esModule",{value:!0}),X.DOMMount=class{constructor(e,t){if(this.doc=e,this.events={},this.handler=this.handleEvent.bind(this),"string"!=typeof t)this.mountNode=t;else{const e=t,n=this.doc.querySelector(e);if(null==n)throw new Error(`unable to locate node for ${{targetSelector:e}}`);this.mountNode=n}}handleEvent(e){}patch(e){if(e instanceof DocumentFragment){const t=e;return k.PatchDOMTree(t,this.mountNode,k.DefaultNodeDictator,!1),void this.registerNodeEvents(t)}if("string"==typeof e){const t=document.createElement("div");return t.innerHTML=e,k.PatchDOMTree(t,this.mountNode,k.DefaultNodeDictator,!1),void this.registerNodeEvents(t)}if(!k.isJSONNode(e))return;const t=e;k.PatchJSONNodeTree(t,this.mountNode,k.DefaultJSONDictator,k.DefaultJSONMaker),this.registerJSONNodeEvents(t)}patchList(e){e.forEach(this.patch.bind(this))}stream(e){const t=JSON.parse(e);return this.streamList(t)}streamList(e){k.StreamJSONNodes(e,this.mountNode,k.DefaultJSONDictator,k.DefaultJSONMaker),e.forEach(this.registerJSONNodeEvents.bind(this))}registerNodeEvents(e){const t=this;p.applyEachNode(e,function(n){n.nodeType===p.ELEMENT_NODE&&e.getAttribute("events").split(" ").forEach(function(e){const n=e.split("-");2===n.length&&t.registerEvent(n[0])})})}registerJSONNodeEvents(e){const t=this;k.applyJSONNodeFunction(e,function(e){e.removed?e.events.forEach(function(e){t.unregisterEvent(e.Name)}):e.events.forEach(function(e){t.registerEvent(e.Name)})})}registerEvent(e){this.events[e]||(this.mountNode.addEventListener(e,this.handler,!0),this.events[e]=!0)}unregisterEvent(e){this.events[e]&&(this.mountNode.removeEventListener(e,this.handler,!0),this.events[e]=!1)}};var K,$,z={},Y=z={};function Z(){throw new Error("setTimeout has not been defined")}function ee(){throw new Error("clearTimeout has not been defined")}function te(e){if(K===setTimeout)return setTimeout(e,0);if((K===Z||!K)&&setTimeout)return K=setTimeout,setTimeout(e,0);try{return K(e,0)}catch(t){try{return K.call(null,e,0)}catch(t){return K.call(this,e,0)}}}!function(){try{K="function"==typeof setTimeout?setTimeout:Z}catch(t){K=Z}try{$="function"==typeof clearTimeout?clearTimeout:ee}catch(t){$=ee}}();var ne,re=[],ie=!1,oe=-1;function se(){ie&&ne&&(ie=!1,ne.length?re=ne.concat(re):oe=-1,re.length&&ae())}function ae(){if(!ie){var e=te(se);ie=!0;for(var n=re.length;n;){for(ne=re,re=[];++oe<n;)ne&&ne[oe].run();oe=-1,n=re.length}ne=null,ie=!1,function(e){if($===clearTimeout)return clearTimeout(e);if(($===ee||!$)&&clearTimeout)return $=clearTimeout,clearTimeout(e);try{$(e)}catch(t){try{return $.call(null,e)}catch(t){return $.call(this,e)}}}(e)}}function ue(e,t){this.fun=e,this.array=t}function ce(){}Y.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];re.push(new ue(e,t)),1!==re.length||ie||te(ae)},ue.prototype.run=function(){this.fun.apply(null,this.array)},Y.title="browser",Y.browser=!0,Y.env={},Y.argv=[],Y.version="",Y.versions={},Y.on=ce,Y.addListener=ce,Y.once=ce,Y.off=ce,Y.removeListener=ce,Y.removeAllListeners=ce,Y.emit=ce,Y.prependListener=ce,Y.prependOnceListener=ce,Y.listeners=function(e){return[]},Y.binding=function(e){throw new Error("process.binding is not supported")},Y.cwd=function(){return"/"},Y.chdir=function(e){throw new Error("process.chdir is not supported")},Y.umask=function(){return 0};var le={};(function(e){"use strict";var n=setTimeout;function r(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function o(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var r=1===e._state?n.onFulfilled:n.onRejected;if(null!==r){var i;try{i=r(e._value)}catch(t){return void a(n.promise,t)}s(n.promise,i)}else(1===e._state?s:a)(n.promise,e._value)})):e._deferreds.push(n)}function s(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var r=n.then;if(n instanceof i)return e._state=3,e._value=n,void u(e);if("function"==typeof r)return void l((o=r,s=n,function(){o.apply(s,arguments)}),e)}e._state=1,e._value=n,u(e)}catch(t){a(e,t)}var o,s}function a(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,a(t,e))})}catch(r){if(n)return;n=!0,a(t,r)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new c(e,t,n)),n},i.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},i.all=function(e){return new i(function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var i=r.length;function o(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){o(e,t)},n)}r[e]=s,0==--i&&t(r)}catch(u){n(u)}}for(var s=0;s<r.length;s++)o(s,r[s])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},i._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},le=i}).call(this,n({}).setImmediate);var fe={};Object.defineProperty(fe,"__esModule",{value:!0}),fe.PromiseAPI={Promise:self.Promise},self.Promise||(fe.PromiseAPI.Promise=le,self.Promise=le);var de={};Object.defineProperty(de,"__esModule",{value:!0}),de.linear=function(e){return e},de.easeInQuad=function(e){return e*e},de.easeOutQuad=function(e){return e*(2-e)},de.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},de.easeInCubic=function(e){return e*e*e},de.easeOutCubic=function(e){return--e*e*e+1},de.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},de.easeInQuart=function(e){return e*e*e*e},de.easeOutQuart=function(e){return 1- --e*e*e*e},de.easeInOutQuart=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},de.easeInQuint=function(e){return e*e*e*e*e},de.easeOutQuint=function(e){return 1+--e*e*e*e*e},de.easeInOutQuint=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e};var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.OneSecond=1e3,he.OneMinute=60*he.OneSecond,he.Socket=class{constructor(e,t,n,r,i){this.addr=e,this.socket=null,this.reader=t,this.maxWait=i,this.userClosed=!1,this.exponent=n,this.disconnected=!1,this.attemptedConnects=0,this.lastWait=he.OneSecond,this.maxReconnect=r,this.writeBuffer=new Array}connect(){if(this.socket)return;if(this.attemptedConnects>=this.maxReconnect)return void this.reader.Exhausted(this);const e=new WebSocket(this.addr);e.addEventListener("open",this._opened.bind(this)),e.addEventListener("error",this._errored.bind(this)),e.addEventListener("message",this._messaged.bind(this)),e.addEventListener("close",this._disconnected.bind(this)),this.socket=e,this.disconnected=!1}send(e){this.disconnected?this.writeBuffer.push(e):this.socket.send(e)}reset(){this.attemptedConnects=0,this.lastWait=he.OneSecond}end(){this.userClosed=!0,this.reader.Closed(this),this.socket.close(),this.socket=null}_disconnected(e){if(this.reader.Disconnected(e,this),this.disconnected=!0,this.socket=null,this.userClosed)return;let t=this.lastWait;this.exponent&&(t=this.exponent(t))>this.maxWait&&(t=this.maxWait),setTimeout(this.connect.bind(this),t),this.attemptedConnects++}_opened(e){for(this.reader.Connected(e,this);this.writeBuffer.length>0;){const e=this.writeBuffer.shift();this.socket.send(e)}}_errored(e){this.reader.Errored(e,this)}_messaged(e){this.reader.Message(e,this)}};var pe={};return Object.defineProperty(pe,"__esModule",{value:!0}),pe.WebVM={dom:p,raf:r,http:D,mount:X,patch:k,utils:l,websocket:he,fetch:C.fetchAPI,extensions:c,promise:fe.PromiseAPI.Promise,vfx:{tween:de,animations:s,interpolations:j}},self.WebVM=pe.WebVM,pe.default=pe.WebVM,pe});